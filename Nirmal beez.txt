CREATE TABLE Vegetables (ID int identity(1,1),Vegetable VARCHAR(40),ImportRate INT,ExportRate INT)

INSERT INTO Vegetables VALUES('Potato',20,60)
INSERT INTO Vegetables VALUES('Brijal',15,45)
INSERT INTO Vegetables VALUES('Bitter Gourd',18,55)
INSERT INTO Vegetables VALUES('Ladies Finger',21,60)
INSERT INTO Vegetables VALUES('Onion',95,275)

Select * from Vegetables
Select * from Export
Select * from Import
CREATE TABLE Export (Vegetable VARCHAR(40),TaxPercentage int)


INSERT INTO Export VALUES('Potato',10 )
INSERT INTO Export VALUES('Brijal',10)
INSERT INTO Export VALUES('Bitter Gourd',10)
INSERT INTO Export VALUES('Ladies Finger',10)
INSERT INTO Export VALUES('Onion',10)

CREATE TABLE Import (Vegetable VARCHAR(40),DiscountAmount int)

INSERT INTO Import VALUES('Potato',5 )
INSERT INTO Import VALUES('Brijal',7 )
INSERT INTO Import VALUES('Bitter Gourd',9 )
INSERT INTO Import VALUES('Ladies Finger',11 )
INSERT INTO Import VALUES('Onion',20 )


SELECT ISNULL(Veg.Vegetable,'') as Vegetable,
(Veg.ExportRate + (veg.Exportrate * Ex.TaxPercentage/100)) as ExportAmount,
(Veg.ImportRate-Im.DiscountAmount) as ImportAmount
FROM Vegetables veg(NOLOCK) 
LEFT JOIN Export Ex ON Ex.Vegetable = veg.Vegetable
LEFT JOIN Import Im ON Im.Vegetable = veg.Vegetable



SELECT ISNULL(Veg.Vegetable,'') as Vegetable,
(Veg.ExportRate + (veg.Exportrate * Ex.TaxPercentage/100)) as ExportAmount,
(Veg.ImportRate-Im.DiscountAmount) as ImportAmount
FROM Vegetables veg(NOLOCK) 
LEFT JOIN Export Ex ON Ex.Vegetable = veg.Vegetable
LEFT JOIN Import Im ON Im.Vegetable = veg.Vegetable
